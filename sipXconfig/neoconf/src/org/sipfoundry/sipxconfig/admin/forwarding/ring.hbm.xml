<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" 
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping package="org.sipfoundry.sipxconfig.admin.forwarding" default-lazy="false">
	<!-- 
	  - Ring
	  -->
	<class name="Ring" table="ring">
		<id name="id" column="ring_id" type="int" unsaved-value="-1">
			<generator class="sequence">
				<param name="sequence">ring_seq</param>
			</generator>
		</id>
		<property name="number"/>
        <property name="position"/>
		<property name="expiration"/>
        <property name="enabled"/>
		<property name="type" column="ring_type" type="org.sipfoundry.sipxconfig.admin.callgroup.AbstractRing$UserType"/>
        <many-to-one name="callSequence" column="user_id" class="CallSequence" not-null="true"/>
	</class>

	<!--
      - Call sequence
      -->  
	<class name="CallSequence" table="users">
		<id name="id" column="user_id" type="int" unsaved-value="-1">
			<generator class="foreign">
				<param name="property">user</param>
			</generator>
		</id>        
        <one-to-one name="user" class="org.sipfoundry.sipxconfig.common.User" constrained="true"/>
        <list name="rings" inverse="true" cascade="all-delete-orphan">
            <key column="user_id"/>
            <index column="position"/>
            <one-to-many class="Ring"/>
        </list>
	</class>
</hibernate-mapping>
