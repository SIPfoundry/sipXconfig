# cfengine cheatsheet
#
# Natural order of promises inside a bundle
#  vars
#  classes
#  outputs
#  interfaces
#  files
#  packages
#  environments
#  methods
#  processes
#  services
#  commands
#  storage
#  databases
#  reports

bundle agent sipx_module {
  commands:
    any::
      "@SIPX_CFMODULES@/sipx"
        module => "true",
	ifvarclass => canonify(fileexists("@SIPX_CFMODULES@/sipx"));
}

bundle agent sipx {
  vars:
    any::
      # Have to turn scalars_ to slists because of bug found in cfengine 3.2.3 and lower versions
      #  https://cfengine.com/bugtracker/view.php?id=865
      "allowed_addrs" slist => splitstring("$(sipx.allowed_addrs_)",":","1000");
      "allowed_users" slist => splitstring("$(sipx.allowed_users_)",":","1000");
}
