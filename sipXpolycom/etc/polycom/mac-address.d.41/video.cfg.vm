<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!--   Generated by sipXecs: http://www.sipfoundry.org/

   Instructions for integrating new configuration file content into sipXconfig:
     http://wiki.sipfoundry.org/display/xecsdev/Adding+Polycom+SoundPoint+IP+New+Configuration+File+Content+into+sipXconfig
-->
#macro (computeCodecSettings $setting $prefix)

   #set ($selected_codecs = $setting.getTypedValue())
   #set ($codec_options = $setting.getType().getEnums().keySet())

   ## Loop through each supported codec.
   #foreach ($codec_option in $codec_options)

      ## Determine the selected preference value of this codec.  (Blank if not selected.)
      #if (${selected_codecs.contains(${codec_option})})
         #set ($codec_value = $math.add($selected_codecs.indexOf($codec_option), "1"))
      #else
         #set ($codec_value = "")
      #end

      ## Generate the codec preference value.
      ${prefix}.${codec_option}="${codec_value}"
   #end
#end
<polycomConfig xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="polycomConfig.xsd">
#if ($phone.model.isSupported("video"))
  <video
#set ($group = $cfg.EndpointSettings.getSetting('video'))
#foreach ($setting in $cfg.getSettings($group))
    video.${setting.ProfileName}="$!{setting.Value}"
#end
  >
    <video.codecPref
#set ($group = $cfg.EndpointSettings.getSetting('video').getSetting('codecPref'))
#foreach ($setting in $cfg.getSettings($group))
      #set ($prefix = "video.codecPref")
      #computeCodecSettings($setting $prefix)
#end
    />
    <video.profile>
     <video.profile.H264
#set ($group = $cfg.EndpointSettings.getSetting('video').getSetting('profile').getSetting('H264'))
#foreach ($setting in $cfg.getSettings($group))
      video.profile.H264.${setting.ProfileName}="$!{setting.Value}"
#end
     />
     <video.profile.H263
#set ($group = $cfg.EndpointSettings.getSetting('video').getSetting('profile').getSetting('H263'))
#foreach ($setting in $cfg.getSettings($group))
      video.profile.H263.${setting.ProfileName}="$!{setting.Value}"
#end
     />
     <video.profile.H2631998
#set ($group = $cfg.EndpointSettings.getSetting('video').getSetting('profile').getSetting('H2631998'))
#foreach ($setting in $cfg.getSettings($group))
      video.profile.H2631998.${setting.ProfileName}="$!{setting.Value}"
#end
     />
     <video.profile.H261
#set ($group = $cfg.EndpointSettings.getSetting('video').getSetting('profile').getSetting('H261'))
#foreach ($setting in $cfg.getSettings($group))
      video.profile.H261.${setting.ProfileName}="$!{setting.Value}"
#end
     />
    </video.profile>
    <video.camera
#set ($group = $cfg.EndpointSettings.getSetting('video').getSetting('camera'))
#foreach ($setting in $cfg.getSettings($group))
      video.camera.${setting.ProfileName}="$!{setting.Value}"
#end
    />
    <video.localCameraView>
     <video.localCameraView.fullScreen
#set ($group = $cfg.EndpointSettings.getSetting('video').getSetting('localCameraView'))
#foreach ($setting in $cfg.getSettings($group))
      video.localCameraView.${setting.ProfileName}="$!{setting.Value}"
#end
    />
    </video.localCameraView>
  </video>
#end
</polycomConfig>